System.register(["jimu-core"],(function(e,t){var o={};return{setters:[function(e){o.AbstractDataAction=e.AbstractDataAction,o.AllDataSourceTypes=e.AllDataSourceTypes,o.DataLevel=e.DataLevel,o.DataSourceStatus=e.DataSourceStatus,o.MutableStoreManager=e.MutableStoreManager,o.getAppStore=e.getAppStore}],execute:function(){e((()=>{"use strict";var e={79244:e=>{e.exports=o}},t={};function n(o){var a=t[o];if(void 0!==a)return a.exports;var r=t[o]={exports:{}};return e[o](r,r.exports,n),r.exports}n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var a={};return(()=>{n.r(a),n.d(a,{default:()=>o});var e=n(79244),t=function(e,t,o,n){return new(o||(o=Promise))((function(a,r){function i(e){try{l(n.next(e))}catch(e){r(e)}}function u(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,u)}l((n=n.apply(e,t||[])).next())}))};class o extends e.AbstractDataAction{isSupported(o,n){return t(this,void 0,void 0,(function*(){var t,a,r,i,u,l,d,c,v,s,p;if(o.length>1)return!1;const f=o[0],S=f.dataSource,g=function(){var t,o,n;return window.jimuConfig.isBuilder?null===(o=null===(t=(0,e.getAppStore)().getState())||void 0===t?void 0:t.appStateInBuilder)||void 0===o?void 0:o.appConfig:null===(n=(0,e.getAppStore)().getState())||void 0===n?void 0:n.appConfig}(),y=null===(t=null==g?void 0:g.widgets)||void 0===t?void 0:t[this.widgetId],h=null===(a=y.config)||void 0===a?void 0:a.configInfo;if(!h||0===Object.keys(h).length)return!1;let D=null===(l=null===(u=null===(r=null==g?void 0:g.widgets)||void 0===r?void 0:r[null===(i=y.useMapWidgetIds)||void 0===i?void 0:i[0]])||void 0===u?void 0:u.config)||void 0===l?void 0:l.initialMapDataSourceID;D||(D=Object.keys(h)[0]);const b=null===(c=null===(d=y.config)||void 0===d?void 0:d.configInfo)||void 0===c?void 0:c[D];if(!((null===(s=null===(v=null==b?void 0:b.analysisSettings)||void 0===v?void 0:v.layersInfo)||void 0===s?void 0:s.length)>0))return!1;if(null===(p=null==b?void 0:b.searchSettings)||void 0===p?void 0:p.searchByActiveMapArea)return!1;if(!S||S.getStatus()===e.DataSourceStatus.NotReady)return!1;return!(!(null==S?void 0:S.supportSpatialInfo)||!(null==S?void 0:S.supportSpatialInfo()))&&!!(f.records.length>0&&n===e.DataLevel.Records&&("current"===f.type||"selected"===f.type)||n===e.DataLevel.DataSource&&[e.AllDataSourceTypes.FeatureLayer].includes(f.dataSource.type))}))}onExecute(o,n){return t(this,void 0,void 0,(function*(){const t=o[0],{records:a,dataSource:r}=t,i={};let u="";return n===e.DataLevel.DataSource?e.MutableStoreManager.getInstance().updateStateValue(this.widgetId,"selectedDataSource",r):(null==a?void 0:a.length)>0&&(a.forEach((e=>{var t;u=null===(t=null==e?void 0:e.dataSource)||void 0===t?void 0:t.id,i[u]||(i[u]=[]),i[u].push(e.feature.geometry)})),e.MutableStoreManager.getInstance().updateStateValue(this.widgetId,"selectedIncidentLocation",i)),!0}))}}})(),a})())}}}));